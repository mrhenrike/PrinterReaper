===================================================================================
                    PRINTERREAPER v2.4.2 - COMPLETE ARCHITECTURE
          109 Commands | 3 Languages | 4 Protocols | 5 Payloads | 95% Coverage
===================================================================================

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              USER INTERFACE LAYER                                 │
│                                                                                   │
│     ┌──────────┐                                         ┌──────────────┐       │
│     │   USER   │  Command: ls /etc/passwd                │   RESULT     │       │
│     │ ┌────┐   │  Mode: auto                             │ /etc/passwd  │       │
│     │ │    │◄──┼─────────────────────────────────────────┤ downloaded   │       │
│     │ └────┘   │  Options: -d -s -q -i -o                │ Successfully │       │
│     └──────────┘                                         └──────────────┘       │
│          │                                                        ▲               │
└──────────┼────────────────────────────────────────────────────────┼───────────────┘
           │                                                        │
           ▼                                                        │
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          APPLICATION ENTRY POINT                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ main.py (Entry Point)                                                    │   │
│  │ ├─> argparse: Parse CLI arguments                                       │   │
│  │ ├─> get_os(): Detect OS (Linux/Win/WSL/macOS/BSD)                      │   │
│  │ ├─> capabilities(): Detect printer language                             │   │
│  │ └─> shell_map[mode]: Select language module                            │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└───────────┬─────────────────────────────────────────────────────────────────────┘
            │
            ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         LANGUAGE TRANSLATION LAYER                                │
│  ┌───────────────────┐  ┌────────────────────┐  ┌────────────────────┐         │
│  │   PJL MODULE      │  │  POSTSCRIPT MODULE │  │    PCL MODULE      │         │
│  │   (pjl.py)        │  │    (ps.py)         │  │    (pcl.py)        │         │
│  ├───────────────────┤  ├────────────────────┤  ├────────────────────┤         │
│  │ 54 Commands       │  │ 40 Commands        │  │ 15 Commands        │         │
│  │                   │  │                    │  │                    │         │
│  │ Translates:       │  │ Translates:        │  │ Translates:        │         │
│  │ ls → @PJL         │  │ ls → filenamefor   │  │ ls → List macros   │         │
│  │ FSDIRLIST...      │  │ all operator       │  │ (virtual)          │         │
│  │                   │  │                    │  │                    │         │
│  │ Uses:             │  │ Uses:              │  │ Uses:              │         │
│  │ • codebook.py     │  │ • operators.py     │  │ • Macro tracking   │         │
│  │ • const.PJL_VOL   │  │ • payloads/        │  │ • const.ESC        │         │
│  └───────────────────┘  └────────────────────┘  └────────────────────┘         │
│            │                     │                       │                       │
│            └─────────────────────┴───────────────────────┘                       │
│                                  │                                                │
└──────────────────────────────────┼────────────────────────────────────────────────┘
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        BASE PRINTER CLASS (printer.py)                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │  CORE FUNCTIONALITY (1,304 lines)                                        │   │
│  │  ├─> do_open/close: Connection management                                │   │
│  │  ├─> do_upload/download: File transfer                                   │   │
│  │  ├─> do_cd/pwd/chvol: Navigation                                         │   │
│  │  ├─> cmd_with_retry: Retry logic (3 attempts)                           │   │
│  │  ├─> setup_signal_handlers: Ctrl+C handling                             │   │
│  │  ├─> onecmd: Command wrapper with timeout                               │   │
│  │  └─> fuzz/mirror: Advanced operations                                   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└──────────────────────────────────┬──────────────────────────────────────────────┘
                                   │
                ┌──────────────────┼──────────────────┐
                │                  │                  │
                ▼                  ▼                  ▼
        ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
        │  DISCOVERY  │    │CAPABILITIES │    │   FUZZER    │
        │ discovery.py│    │capabilities │    │  fuzzer.py  │
        ├─────────────┤    ├─────────────┤    ├─────────────┤
        │ SNMP Scan   │    │ IPP Check   │    │ 254 paths   │
        │ 17 OIDs     │    │ HTTP Check  │    │ 31 names    │
        │ Multi-OS    │    │ SNMP Check  │    │ Traversal   │
        └─────────────┘    └─────────────┘    └─────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            UTILITY ENGINES LAYER                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │  HELPER UTILITIES (helper.py - 705 lines)                               │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐    │   │
│  │  │ output() │ │  conv()  │ │  file()  │ │  conn()  │ │  log()   │    │   │
│  │  ├──────────┤ ├──────────┤ ├──────────┤ ├──────────┤ ├──────────┤    │   │
│  │  │ Colors   │ │ Elapsed  │ │ Read     │ │ Socket   │ │ Open     │    │   │
│  │  │ Message  │ │ Filesize │ │ Write    │ │ Send     │ │ Write    │    │   │
│  │  │ Warning  │ │ Hex conv │ │ Append   │ │ Recv     │ │ Comment  │    │   │
│  │  │ Error    │ │ Int safe │ │          │ │ Timeout  │ │ Close    │    │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
│  ┌───────────────┐  ┌────────────────┐  ┌────────────────┐  ┌──────────────┐ │
│  │  CODEBOOK     │  │    OPERATORS   │  │    PAYLOADS    │  │   FUZZER     │ │
│  │ codebook.py   │  │  operators.py  │  │   payloads/    │  │  fuzzer.py   │ │
│  ├───────────────┤  ├────────────────┤  ├────────────────┤  ├──────────────┤ │
│  │ 378 Codes     │  │ 371 Operators  │  │ 5 Templates    │  │ 381 Vectors  │ │
│  │ get_errors()  │  │ 16 Categories  │  │ load_payload() │  │ 4 Methods    │ │
│  └───────────────┘  └────────────────┘  └────────────────┘  └──────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          NETWORK PROTOCOL LAYER                                   │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │  Protocol Selection & Routing                                            │   │
│  │  ┌────────┐    ┌────────┐    ┌────────┐    ┌────────┐                 │   │
│  │  │  RAW   │    │  LPD   │    │  IPP   │    │  SMB   │                 │   │
│  │  │ :9100  │    │  :515  │    │  :631  │    │  :445  │                 │   │
│  │  └────┬───┘    └────┬───┘    └────┬───┘    └────┬───┘                 │   │
│  │       └─────────────┼─────────────┼─────────────┘                       │   │
│  └──────────────────────┼──────────────────────────────────────────────────┘   │
└─────────────────────────┼──────────────────────────────────────────────────────┘
                          │
                          ▼
                  ┌───────────────┐
                  │  TCP/IP STACK │
                  │    (socket)   │
                  └───────┬───────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            TARGET PRINTER                                         │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │  Printer Components:                                                     │   │
│  │  ├─> PJL Interpreter (HP standard)                                      │   │
│  │  ├─> PostScript Interpreter (Level 2/3)                                 │   │
│  │  ├─> PCL Interpreter (PCL5/6)                                           │   │
│  │  ├─> Filesystem (0:, 1:, /etc, /webServer)                             │   │
│  │  ├─> NVRAM (passwords, settings)                                        │   │
│  │  ├─> Job Queue (print jobs)                                             │   │
│  │  ├─> Network Stack (IP, MAC, WiFi)                                      │   │
│  │  └─> Control Panel (display, buttons)                                   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                          │
                          │ Response: File data, status codes
                          ▼
        [Back to USER via reverse path]
```

---

## 📐 Comparison: Old PRET vs New PrinterReaper

```
OLD PRET ARCHITECTURE:                  NEW PRINTERREAPER v2.4.2:
========================                ===========================

User Command (ls)                       User Command (ls /etc)
      │                                       │
      ▼                                       ▼
┌────────────┐                         ┌─────────────────────┐
│  Attacker  │                         │  main.py Entry      │
│            │                         │  ├─> OS Detect      │
│            │                         │  ├─> Capabilities   │
│            │                         │  └─> Discovery      │
└─────┬──────┘                         └──────────┬──────────┘
      │                                            │
      ▼                                            ▼
┌────────────┐                         ┌─────────────────────┐
│ Translator │                         │  Language Selector  │
│  ├─ PJL    │                         │  ├─> PJL (54 cmd)   │
│  ├─ PS     │                         │  ├─> PS (40 cmd)    │
│  └─ Fuzzer │                         │  └─> PCL (15 cmd)   │
└─────┬──────┘                         └──────────┬──────────┘
      │                                            │
      │                                            ├─> Base: printer.py
      │                                            ├─> Engines:
      │                                            │   ├─ codebook (378 codes)
      │                                            │   ├─ fuzzer (381 vectors)
      │                                            │   ├─ operators (371 ops)
      │                                            │   └─ payloads (5 attacks)
      │                                            │
      ▼                                            ▼
┌────────────┐                         ┌─────────────────────┐
│ Connector  │                         │  Protocol Layer     │
│  (socket)  │                         │  ├─> RAW (9100)     │
│            │                         │  ├─> LPD (515)      │
│            │                         │  ├─> IPP (631)      │
│            │                         │  └─> SMB (445)      │
└─────┬──────┘                         └──────────┬──────────┘
      │                                            │
      │                                            ▼
      │                                  ┌──────────────────┐
      │                                  │  conn() Manager  │
      │                                  │  ├─ Timeout 30s  │
      │                                  │  ├─ Retry logic  │
      │                                  │  └─ Watchdog     │
      │                                  └────────┬─────────┘
      ▼                                           ▼
┌────────────┐                         ┌─────────────────────┐
│  Logging   │                         │  Full Logging Suite │
│            │                         │  ├─> Terminal output│
│            │                         │  ├─> File logging   │
│            │                         │  ├─> Debug mode     │
│            │                         │  └─> Error tracking │
└────────────┘                         └─────────────────────┘
      │                                            │
      ▼                                            ▼
┌────────────┐                         ┌─────────────────────┐
│ Scripting  │                         │  Advanced Features  │
│            │                         │  ├─> Auto-detect    │
│            │                         │  ├─> Multi-protocol │
│            │                         │  ├─> Payload system │
│            │                         │  ├─> Operator enum  │
│            │                         │  └─> QA tested      │
└────────────┘                         └─────────────────────┘
      │                                            │
      ▼                                            ▼
[  PRINTER  ]                           [  TARGET PRINTER  ]


IMPROVEMENTS:
=============
✅ 3 languages (same as PRET)
✅ 4 protocols (vs 1 in PRET) +300%
✅ 109 commands (vs ~85 in PRET) +28%
✅ Comprehensive engines (codebook, fuzzer, operators, payloads)
✅ Modern Python 3.8+ (vs Python 2.7)
✅ Complete documentation (wiki 14 pages)
✅ 100% QA tested (vs no tests in PRET)
✅ Active maintenance (vs abandoned PRET)

